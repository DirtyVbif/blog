"use strict";class CookieAgreement{constructor(){this.s={trigger:"#cookie-agreement",hidden_class:"hidden",ajax_path:"/ajax/cookie",show_times:3},this.modal,this.window_resize_event,this.submit,this.form}initialize(){this.modal=document.querySelector(this.s.trigger),this.form=document.querySelector(this.s.trigger+" form"),this.submit=document.querySelector(this.s.trigger+' form input[type="submit"]'),this.modal&&this.form&&this.submit&&(isCookieAccepted()?this._setAsAccepted():this._createEvent())}_createEvent(){let e=localStorage.getItem("cookie-agreement-show-times")??0;if(e="NaN"==parseInt(e)?this.s.show_times:parseInt(e),e>this.s.show_times)return this._setAsAccepted();localStorage.setItem("cookie-agreement-show-times",++e),this.modal.classList.remove(this.s.hidden_class),this._setBottomOffset(),this.submit.addEventListener("click",(e=>{this._acceptCookies(e)}))}_setBottomOffset(){this._setDocumentBottomOffset(),window.addEventListener("resize",(e=>{this.window_resize_event=e,this._setDocumentBottomOffset()}))}_setDocumentBottomOffset(e=!1){let t=null;e||(t=parseFloat(this.modal.offsetHeight)+"px"),document.body.style.marginBottom=t}_removeBottomOffset(){this.window_resize_event&&window.removeEventListener("resize",this.window_resize_event),this._setDocumentBottomOffset(!0)}_acceptCookies(e){e.preventDefault(),this._removeBottomOffset(),this._setAsAccepted()}_setAsAccepted(){localStorage.setItem("cookie-agreement-accepted",1),this.modal.remove();let e=new FormData(this.form);fetch(this.s.ajax_path,{method:"post",body:e}).then((e=>e.json())).then((e=>console.log(e))).catch((e=>console.warn(e)))}}