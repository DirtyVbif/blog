class ItemProjectorList{get s(){return{interval:1e4,delay:15e3,animtime:400}}constructor(e,t,i){this.list=e,this.items=t,this.placeholder=i,this.projected_item=-1,this.last_projected_items=[],this.callback=null,this.timer=null,this.delay=null}newRandomItemIndex(){let e=Math.randomInt(this.items.length)-1;if(this.last_projected_items.length<this.items.length)for(;this.last_projected_items.includes(e);)e=Math.randomInt(this.items.length)-1;else for(this.last_projected_items=[];e==this.projected_item;)e=Math.randomInt(this.items.length)-1;return e}projectNewItem(e,t,i=!1){this.projected_item=t,this._animateProjecting(e),this.last_projected_items.length>=this.items.length&&(this.last_projected_items=[]),this.last_projected_items.includes(t)||this.last_projected_items.push(t),i?this._setDelayRandomProjecting():this._setNewRandomizerInterval()}setRandomProjectionTimer(e){this.callback=e,this._setNewRandomizerInterval()}_clearCurrentTimer(){null!=this.timer&&clearInterval(this.timer)}_setNewRandomizerInterval(){this._clearCurrentTimer(),this._clearCurrentDelay(),null!=this.callback&&(this.timer=setInterval(this.callback,this.s.interval))}_setDelayRandomProjecting(){this._clearCurrentTimer(),this.delay=setTimeout((()=>{this._setNewRandomizerInterval()}),this.s.delay)}_clearCurrentDelay(){null!=this.delay&&clearTimeout(this.delay)}_animateProjecting(e){let t=this._getPlaceholderCurrentHeight(),i=this._getPlaceholderNewHeight(e);this._animatePlaceholderChildrenFadeout(),this._animatePlaceholderSizeChanging(t,i),setTimeout((()=>{this.placeholder.innerHTML="",e.style.opacity=0,this.placeholder.appendChild(e),this._animatePlaceholderChildFadein(e)}),this.s.animtime/2)}_animatePlaceholderChildrenFadeout(){for(const e of this.placeholder.children)e.animate([{opacity:1},{opacity:0}],{duration:this.s.animtime/2}).onfinish=()=>{e.remove()}}_animatePlaceholderChildFadein(e){e.animate([{opacity:0},{opacity:1}],{duration:this.s.animtime/2}).onfinish=()=>{e.removeAttribute("style")}}_animatePlaceholderSizeChanging(e,t){this.placeholder.animate([{height:e+"px"},{height:t+"px"}],{duration:this.s.animtime}).onfinish=()=>{this.placeholder.removeAttribute("style")}}_getPlaceholderCurrentHeight(){return parseFloat(this.placeholder.offsetHeight)}_getPlaceholderNewHeight(e){let t=getComputedStyle(this.placeholder),i=(parseFloat(t.borderTopWidth)||0)+(parseFloat(t.borderBottomWidth)||0)+(parseFloat(t.paddingTop)||0)+(parseFloat(t.paddingBottom)||0),a=e.cloneNode(!0);a.style.visibility="hidden",a.style.position="absolute",a.style.zIndex=-999,a.style.opacity=0,this.placeholder.appendChild(a);let l=getComputedStyle(a),s=parseFloat(l.marginTop),r=parseFloat(l.marginBottom),h=parseFloat(a.offsetHeight)+s+r+i;return a.remove(),h}}