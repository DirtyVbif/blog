class EntityStatsElement{get s(){return{trigger_views:".js-entity__views",trigger_rating:".js-entity__rating",data:{id:"data-entity-id",type:"data-entity-type",disable:"data-entity-disable"}}}constructor(t){this.element=t,this.id,this.type,this.views,this.rating,this.disabled=[]}init(){this._checkDisabledStats(),this.id=parseInt(this.element.getAttribute(this.s.data.id)),this.type=this.element.getAttribute(this.s.data.type),this.controller=this.element.getAttribute(this.s.data.ctrl),this.views=new EntityStatsViews(this),this.rating=new EntityStatsRating(this)}_checkDisabledStats(){let t=this.element.getAttribute(this.s.data.disable);t&&(this.disabled=t.split(new RegExp(",s*")))}statEnabled(t){return!this.disabled.includes(t)}onload(){this.views.update(),this.rating.init()}async makeRequest(t){let e=[];for(const[s,i]of Object.entries(t))s&&i?e.push(s+"="+i):s?e.push(s):i&&e.push(i);if(e.length<1)return;e.push("entity_id="+this.id),e.push("entity_type="+this.type);let s="/ajax/entity?"+e.join("&");await this._sendRequest(s)}async _sendRequest(t){await fetch(t).then((t=>t.json())).then((t=>{(!t.status||t.status<200||t.status>299)&&console.warn(t)})).catch((t=>{console.warn(t)}))}}